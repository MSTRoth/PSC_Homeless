setwd("~/Other Requests/Paul")

INLBGOV <- read_csv("INL 2017.csv")
colnames(INL)
INL_member1 <- INL %>% 
  filter()



##########USASpending###############

INL <- read_csv("INL 2017_USA.csv")


INL_merge <- INL %>% 
  left_join(INLBGOV, by = c("award_id_piid" = "Contract Number")) %>% 
  filter(!is.na(INL_merge$`Funding Office Level 4`))


INL_merge1 <- INL_merge %>% 
  filter(recipient_duns %in% c(079183903, 073083847, 933900110, 043397520, 139727148, 964649771, 
                               128345266, 218272568, 039872622, 008050242, 195057666, 153561212, 
                               010334451, 879783983, 079358600, 808465913, 965048981, 077799799, 
                               847230935, 791152460,  081133960, 168719552, 079897769, 873109743, 
                               079279736, 963009899, 074835299, 135908783, 084925908, 053230355, 
                               827560744, 831112466, 217304393,  140040440, 080647065, 047684840, 
                               006078659, 100128086, 080116673, 040535759, 016533093, 190430231, 
                               040767357, 360980275, 187432356, 964027150, 807021241, 045534641, 
                               134637214, 964420181, 752323712, 055990261,  050911668, 145969783, 
                               003252764, 867714768, 622692994, 071844021, 958656506, 184456155, 
                               079646374, 087701231, 800303427,  959711631, 126497122, 015822541, 
                               091345579, 079120822, 113045715, 066781956,  079728225, 079716020, 
                               083662916, 627002504, 807776476, 115410404, 603465873, 014127109, 
                               137812298, 143047319, 035995262, 807521521, 926140880, 144344947, 
                               093781201,  068678788,  088661470, 142428783, 010524531, 170945823, 
                               111471350, 805890832, 111092144, 806026852, 018095799, 171898732, 042811732, 
                               826018041, 078294271, 079960153,  807834978, 052689697, 782053979, 825894421, 
                               129842667, 048382386, 067641597, 159708080,  128159105, 825047165, 942207838, 
                               044154871, 557581779,  781925669, 119756240, 119235146, 003385163, 808352202, 
                               967362331, 001368083, 611390592, 609378500, 804891851, 961739898, 015277887, 
                               831574475, 788395994, 867267049, 023020097, 078727434, 077548964, 168457054, 
                               831611756, 169988578, 137011347, 161157631, 059493648, 142300222, 960186075, 
                               005317927, 080518529, 784072626, 830172552, 186576310, 827110136, 072650484, 
                               968228473 , 124117040, 073570124, 837359421 , 035207807, 611641312, 053385738, 
                               122563914, 150013212, 079451074, 789092293, 078796124, 965186302, 147719041, 
                               610509171, 962463204, 364221593, 96356670, 184033744, 79282048, 81466849, 25416788, 
                               80453622, 829669568, 13358002,  74837444, 111994625, 620864504, 802054742, 80344217, 
                               832889575, 967356127,  42815709, 849271473, 139118132, 80773846, 962707217, 963664193, 
                               80956611, 035351231, 044435766, 79959254, 192252377, 965953719, 9043600, 048005938, 
                               603649943, 80539699, 794617803, 78641168, 193372638, 603124512, 80419664, 963879585, 
                               122315930,  144103335, 608999520, 180547119, 796450364, 830764036, 832953595, 78357578, 
                               601242910, 078745061, 849550983,  89481720, 78311932, 079854666, 790905512,  832644186, 
                               175955335, 91340943, 941533911, 130683001, 783349926, 169819476, 831369751, 74418872, 
                               147225528, 55329253, 62330220, 79987945, 80966157, 79086353, 14125442, 11506149, 152920005, 
                               128874877, 23381914, 789111697, 103079443,  623214574, 801224564, 147223796, 68512610, 
                               8473170,  8106627, 79100936, 80902552, 114391543, 180451957,  150780674, 72645393, 
                               080132771, 114395759, 30290337, 112892976, 626999247, 930100094,  131873457, 049508120, 
                               933645991, 614948396, 831726588, 608717450,  54045922, 058595539, 345880595, 078884125, 
                               083448961, 044148919, 095250895, 348259818, 009683442, 786429894, 057399758, 828357322, 
                               080858185, 013096156, 555498187, 078382414, 197959315, 153804570, 809558583, 144002347, 
                               806257486, 081250451, 081093775, 024850237, 782539613, 098700362, 187107958, 832622653, 
                               828881289, 019121586, 120838248, 078379446, 080783898, 108195405, 933093676, 835130485, 
                               111410184, 947889077, 965779742105682194, 961665820, 079290695, 001667906, 036537413, 
                               097815026,  079433107, 080452146, 807466201, 96500483, 80649407, 807906107, 186295239, 
                               102874034, 038267076, 078883327, 079209257, 014387489, 967026803, 928859149, 123128329, 
                               783651011, 969592638, 78405331, 74814948, 084915540, 7925286920, 803226230, 09585279, 
                               968336701))


INL_merge2 <- INL_merge %>%
  filter(recipient_parent_duns %in% c(079183903, 073083847, 933900110, 043397520, 139727148, 964649771, 
                               128345266, 218272568, 039872622, 008050242, 195057666, 153561212, 
                               010334451, 879783983, 079358600, 808465913, 965048981, 077799799, 
                               847230935, 791152460,  081133960, 168719552, 079897769, 873109743, 
                               079279736, 963009899, 074835299, 135908783, 084925908, 053230355, 
                               827560744, 831112466, 217304393,  140040440, 080647065, 047684840, 
                               006078659, 100128086, 080116673, 040535759, 016533093, 190430231, 
                               040767357, 360980275, 187432356, 964027150, 807021241, 045534641, 
                               134637214, 964420181, 752323712, 055990261,  050911668, 145969783, 
                               003252764, 867714768, 622692994, 071844021, 958656506, 184456155, 
                               079646374, 087701231, 800303427,  959711631, 126497122, 015822541, 
                               091345579, 079120822, 113045715, 066781956,  079728225, 079716020, 
                               083662916, 627002504, 807776476, 115410404, 603465873, 014127109, 
                               137812298, 143047319, 035995262, 807521521, 926140880, 144344947, 
                               093781201,  068678788,  088661470, 142428783, 010524531, 170945823, 
                               111471350, 805890832, 111092144, 806026852, 018095799, 171898732, 042811732, 
                               826018041, 078294271, 079960153,  807834978, 052689697, 782053979, 825894421, 
                               129842667, 048382386, 067641597, 159708080,  128159105, 825047165, 942207838, 
                               044154871, 557581779,  781925669, 119756240, 119235146, 003385163, 808352202, 
                               967362331, 001368083, 611390592, 609378500, 804891851, 961739898, 015277887, 
                               831574475, 788395994, 867267049, 023020097, 078727434, 077548964, 168457054, 
                               831611756, 169988578, 137011347, 161157631, 059493648, 142300222, 960186075, 
                               005317927, 080518529, 784072626, 830172552, 186576310, 827110136, 072650484, 
                               968228473 , 124117040, 073570124, 837359421 , 035207807, 611641312, 053385738, 
                               122563914, 150013212, 079451074, 789092293, 078796124, 965186302, 147719041, 
                               610509171, 962463204, 364221593, 96356670, 184033744, 79282048, 81466849, 25416788, 
                               80453622, 829669568, 13358002,  74837444, 111994625, 620864504, 802054742, 80344217, 
                               832889575, 967356127,  42815709, 849271473, 139118132, 80773846, 962707217, 963664193, 
                               80956611, 035351231, 044435766, 79959254, 192252377, 965953719, 9043600, 048005938, 
                               603649943, 80539699, 794617803, 78641168, 193372638, 603124512, 80419664, 963879585, 
                               122315930,  144103335, 608999520, 180547119, 796450364, 830764036, 832953595, 78357578, 
                               601242910, 078745061, 849550983,  89481720, 78311932, 079854666, 790905512,  832644186, 
                               175955335, 91340943, 941533911, 130683001, 783349926, 169819476, 831369751, 74418872, 
                               147225528, 55329253, 62330220, 79987945, 80966157, 79086353, 14125442, 11506149, 152920005, 
                               128874877, 23381914, 789111697, 103079443,  623214574, 801224564, 147223796, 68512610, 
                               8473170,  8106627, 79100936, 80902552, 114391543, 180451957,  150780674, 72645393, 
                               080132771, 114395759, 30290337, 112892976, 626999247, 930100094,  131873457, 049508120, 
                               933645991, 614948396, 831726588, 608717450,  54045922, 058595539, 345880595, 078884125, 
                               083448961, 044148919, 095250895, 348259818, 009683442, 786429894, 057399758, 828357322, 
                               080858185, 013096156, 555498187, 078382414, 197959315, 153804570, 809558583, 144002347, 
                               806257486, 081250451, 081093775, 024850237, 782539613, 098700362, 187107958, 832622653, 
                               828881289, 019121586, 120838248, 078379446, 080783898, 108195405, 933093676, 835130485, 
                               111410184, 947889077, 965779742105682194, 961665820, 079290695, 001667906, 036537413, 
                               097815026,  079433107, 080452146, 807466201, 96500483, 80649407, 807906107, 186295239, 
                               102874034, 038267076, 078883327, 079209257, 014387489, 967026803, 928859149, 123128329, 
                               783651011, 969592638, 78405331, 74814948, 084915540, 7925286920, 803226230, 09585279, 
                               968336701))


INL_merge <- rbind(INL_merge1, INL_merge2)

INL_members <- INL_merge %>% 
  select(award_id_piid, `Transaction Value`, `Transaction Signed Date`, `Funding Office Level 4`, recipient_name, recipient_parent_name, `Parent Vendor`, `Performing Vendor`) %>% 
  filter(`Transaction Value` != 0)

write.csv(INL_members, "INL Members Contracts 2017.csv")
